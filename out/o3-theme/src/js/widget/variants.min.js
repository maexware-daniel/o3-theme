document.addEventListener("DOMContentLoaded",function(){const a=()=>{document.querySelectorAll("#variants .dropDown .form-select").forEach(r=>{r.addEventListener("change",u)})},u=r=>{r.preventDefault();const o=document.querySelector(".js-oxWidgetReload");let e=d(o);const n=document.querySelectorAll("select[name^=varselid]","form.js-oxProductForm");e+=Array.from(n).map((t,c)=>`&varselid%5B${c}%5D=${encodeURIComponent(t.value)}`).join(""),fetch(`/widget.php?${e}`,{method:"GET"}).then(t=>{if(!t.ok)throw new Error("Netzwerk-Antwort war nicht ok");return t.text()}).then(t=>{document.querySelector('[data-js="reload"]').outerHTML=t,a(),document.querySelector(".details__picture-thumbnails")&&initPictureSlider(),document.querySelectorAll('[data-js="productslider"]').forEach(c=>{const l=c.getAttribute("data-id");initProductSlider(l)})}).catch(t=>{console.error("Fetch-Fehler:",t)})};a();const d=r=>Array.from(r.elements).reduce((o,e)=>(!e.name||e.disabled||["file","reset","submit","button"].includes(e.type)||(e.type==="select-multiple"?Array.from(e.options).forEach(n=>{n.selected&&o.push(`${encodeURIComponent(e.name)}=${encodeURIComponent(n.value)}`)}):(e.type!=="checkbox"&&e.type!=="radio"||e.checked)&&o.push(`${encodeURIComponent(e.name)}=${encodeURIComponent(e.value)}`)),o),[]).join("&")});
