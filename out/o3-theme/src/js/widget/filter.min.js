function debounce(s,e){let t;return function(...a){clearTimeout(t),t=setTimeout(()=>s.apply(this,a),e)}}function toggleFilterValues(s,e,t,i=!1){const a=parseInt(s.dataset.valueNumber,10)||10,n=e.querySelector("path");t?(s.style.maxHeight="none",s.dataset.expanded="true",i&&(s.dataset.userExpanded="true"),e.firstChild.nodeValue=`${e.dataset.langLess} `,n&&n.setAttribute("d","M1.875 6.75L5 4.25L8.125 6.75")):(s.style.maxHeight=`${a*40}px`,s.dataset.expanded="false",i&&(s.dataset.userExpanded="false"),e.firstChild.nodeValue=`${e.dataset.langMore} `,n&&n.setAttribute("d","M1.875 4.25L5 6.75L8.125 4.25"))}function updateFilterButton(s){const e=s.querySelector('[data-js="listing:filter-show-more"]'),t=s.querySelector('[data-js="listing:filter-values"]');if(!e||!t)return;const i=s.querySelectorAll('[data-js="listing:filter-item"], .form-check'),a=Array.from(i).filter(o=>o.style.display!=="none"),n=parseInt(t.dataset.valueNumber,10)||10,r=t.dataset.userExpanded==="true",l=t.dataset.expanded==="true";a.length>n?(e.style.display="",r&&toggleFilterValues(t,e,!0)):(e.style.display="none",!r&&l&&toggleFilterValues(t,e,!1))}function handleFilterSearch(s){const e=s.value.trim().toLowerCase(),t=s.closest(".collapse");if(!t?.id)return;t.querySelectorAll('[data-js="listing:filter-item"], .form-check').forEach(a=>{const n=a.querySelector("label");if(!n)return;const r=n.textContent.trim().toLowerCase();a.style.display=!e||r.includes(e)?"":"none"}),updateFilterButton(t)}const debouncedFilterSearch=debounce(handleFilterSearch,150);document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('[data-js="listing:filter"]').forEach(e=>{const t=e.closest("#offcanvas__filter")!==null,i={};e.addEventListener("change",function(a){const n=a.target;if(!n.classList.contains("form-check-input"))return;const r=n.closest(".collapse")?.querySelector('input[type="hidden"]');if(!r)return;const l=r.name;i[l]=i[l]||[],n.checked?i[l].includes(n.value)||i[l].push(n.value):i[l]=i[l].filter(o=>o!==n.value),t||(r.value=i[l].join(","),e.submit())}),t&&document.querySelector('[data-js="listing:filter-apply"]')?.addEventListener("click",function(){Object.entries(i).forEach(([n,r])=>{const l=e.querySelector(`input[name="${n}"]`);l&&(l.value=r.join(","))})})}),document.addEventListener("input",function(e){e.target.matches('[data-js="listing:filter-search"]')&&debouncedFilterSearch(e.target)}),document.addEventListener("click",function(e){const t=e.target.closest('[data-js="listing:filter-show-more"]');if(!t)return;const a=t.closest(".collapse")?.querySelector('[data-js="listing:filter-values"]');if(!a)return;const n=a.dataset.expanded==="true";toggleFilterValues(a,t,!n,!0)})});
